<tr id="<%= dom_id(run) %>" class="hover:bg-gray-50">
  <td class="px-6 py-4 whitespace-nowrap">
    <div class="flex items-center">
      <div>
        <div class="text-sm font-medium text-gray-900">
          <%= run.agent.name %>
        </div>
        <div class="text-xs text-gray-500">
          <%= run.agent.key %>
        </div>
      </div>
    </div>
  </td>
  <td class="px-6 py-4">
    <div class="text-sm text-gray-900">
      <%= run.work_item.payload["title"] || "Work Item ##{run.work_item.id}" %>
    </div>
    <div class="text-xs text-gray-500">
      <%= run.work_item.work_type %>
    </div>
  </td>
  <td class="px-6 py-4 whitespace-nowrap">
    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium <%= run_status_badge_class(run.outcome) %>">
      <%= run_status_text(run.outcome, run.started_at, run.finished_at) %>
    </span>
  </td>
  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
    <% if run.started_at %>
      <time datetime="<%= run.started_at.iso8601 %>" title="<%= run.started_at.strftime("%B %d, %Y at %l:%M %p") %>">
        <%= time_ago_in_words(run.started_at) %> ago
      </time>
    <% else %>
      <span class="text-gray-400">Not started</span>
    <% end %>
  </td>
  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
    <%= run_duration(run.started_at, run.finished_at) %>
  </td>
  <td class="px-6 py-4 whitespace-nowrap text-sm">
    <div class="flex space-x-2">
      <% if run.github_pr_number || run.work_item.payload["github_pr_url"] %>
        <% pr_url = run.work_item.payload["github_pr_url"] || (run.work_item.project.repo_full_name && "https://github.com/#{run.work_item.project.repo_full_name}/pull/#{run.github_pr_number}") %>
        <% if pr_url %>
          <%= link_to "PR", pr_url,
              target: "_blank",
              class: "text-indigo-600 hover:text-indigo-900", rel: "noopener" %>
        <% end %>
      <% end %>
      <% if run.work_item.payload["github_issue_url"] %>
        <%= link_to "Issue", run.work_item.payload["github_issue_url"],
            target: "_blank",
            class: "text-indigo-600 hover:text-indigo-900", rel: "noopener" %>
      <% end %>
      <% if run.safe_logs_url.present? %>
        <%= link_to "Logs", run.safe_logs_url,
            target: "_blank",
            class: "text-indigo-600 hover:text-indigo-900", rel: "noopener" %>
      <% elsif run.logs.present? %>
        <button type="button"
                data-controller="modal"
                data-action="click->modal#open"
                data-modal-content-value="<%= j(run.logs) %>"
                class="text-indigo-600 hover:text-indigo-900">
          Logs
        </button>
      <% end %>
      <% if run.safe_artifacts_url.present? %>
        <%= link_to "Artifacts", run.safe_artifacts_url,
            target: "_blank",
            class: "text-indigo-600 hover:text-indigo-900", rel: "noopener" %>
      <% end %>
    </div>
  </td>
</tr>
